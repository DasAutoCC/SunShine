function showMarkdown(a){var b;$.get(restUrl.获取博客详细内容,{blogId:a},function(c){return $("#markDownArea").html("<textarea  id='hahahdh' style='display: none;'></textarea>"),200==c.respCode?void(b=editormd.markdownToHTML("markDownArea",{markdown:c.data.articleContent,htmlDecode:"style,script,iframe",tocm:!0,tocContainer:".right",emoji:!0,taskList:!0,tex:!0,flowChart:!0,sequenceDiagram:!0}),$("#markDownArea").attr("name",a),$("#articleHeader").text(c.data.articleHeader),$("#authorMsgArea").html("<span>Author:\u76DB\u4E16\u7E41\u82B1&nbsp;&nbsp;|&nbsp;&nbsp;&nbspPOST:"+new Date(c.data.createTime).toLocaleString()+"</span>")):void alert("\u8BF7\u6C42\u5931\u8D25:"+c.message)})}function getAllUserDetails(a){var b=new Set,c={userId:a.commentId,userHeader:a.userHead,userName:a.nickName};b.add(c);var d=a.replies;if(null==d)return b;for(i=0;i<d.length;i++){var c={userId:d[i].commentId,userHeader:d[i].userHead,userName:d[i].nickName};b.add(c)}var e=Array.from(b);return e}function findUserDetailsFromList(a,b){var c=null;for(i=0;i<a.length;i++)if(a[i].userId==b)return c=a[i],c;return c}function findTheUser(a,b){if(a.commentId==b)return a.commentUser;if(null==a.replies||0>=a.replies.length)return null;for(i=0;i<a.replies.length;i++)if(a.replies[i].commentUser==b)return a.replies[i].commentUser;return null}function addCommentToDom(a){var b=getAllUserDetails(a),c="",d="</div>",e="",f="",g=null==a.nickName?"\u6E38\u5BA2":a.nickName,h=a.commentContent;if(e="<div class=\"topLevelComment\" id="+a.commentId+" userName = "+g+"><div class=\"contentsTheHeaderArea\"><div class=\"commentUserHeader allCommentInstance\"><img class=\"commentUserHeaderInstance\" src=\""+a.userHead+"\" /> </div><div class=\"commentUserNameAndPostTime\"><div class=\"commentUserNameInstance\">"+g+"<a class=\"theReplyButton\">\u56DE\u590D</a> </div><div class=\"commentPostTimeInstance\">"+new Date(a.createTime).toLocaleString()+"</div></div></div><div class=\"commentContentArea\">"+h+"</div></div>",c="<div class=\"realComment\">"+e,null==a.replies||0==a.replies.length)return c+=d,c;for(var j=0;j<a.replies.length;j++){var k=a.replies[j].replyFor,l=findTheUser(a,k),m=findUserDetailsFromList(b,k),n=null==a.replies[j].nickName?"\u6E38\u5BA2":a.replies[j].nickName;f=f+"<div class=\"reply\" id="+a.replies[j].commentId+" userName = "+n+"><div class=\"contentsTheHeaderArea\"><div class=\"commentUserHeader allCommentInstance\"><img class=\"commentUserHeaderInstance\" src=\""+a.replies[j].userHead+"\" /> </div><div class=\"commentUserNameAndPostTime\"><div class=\"commentUserNameInstance\">"+n+" \u56DE\u590D\uFF1A"+m.userName+"<a class=\"theReplyButton\">\u56DE\u590D</a> </div><div class=\"commentPostTimeInstance\">"+new Date(a.replies[j].createTime).toLocaleString()+"</div></div></div><div class=\"commentContentArea\">"+a.replies[j].commentContent+"</div></div>"}return c=c+f+d,c}function showComment(a){$("#commentInstence").html("");var b="";$.get(restUrl.当前博客下的所有评论,{blogId:a},function(a){if(200!=a.respCode)return alert(a.message),null;var c=a.data;if("\u5F53\u524D\u6587\u7AE0\u6682\u65E0\u8BC4\u8BBA"==c)return null;for(var d=0;d<c.length;d++)rep=addCommentToDom(c[d]),b+=rep;$("#commentInstence").html(b)})}function addLoginMsgToDom(){""!=isLogin&&200==isLogin.respCode&&($("#indexDivSpan1").html(isLogin.data.userName+",\u6B22\u8FCE\u56DE\u6765"),$("#loginArea").html("<div id='userNameDiv'>"+isLogin.data.userName+"<a href='/logout' id='logoutA'>\u9000\u51FA</a></div><div id='userHeaderDiv'><img id='userHeader' src="+isLogin.data.userHeader+"></div>"),$("#write").attr("placeholder","\u8D60\u4EBA\u73AB\u7470\uFF0C\u624B\u6709\u4F59\u9999"))}function addWelcomeMsgToDom(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=b+":"+c+"&nbsp;";d+=0<b&12>=b?"AM":"PM",$("#indexDivSpan").html(d),$.get("/welcome",{},function(a){200==a.respCode&&(welcome=a.data.welcome,headerMsg=a.data.headerMsg,timeMsg=a.data.timeMsg),$("#text").html(headerMsg),""==isLogin&&200!=isLogin.respCode&&$("#indexDivSpan1").html(timeMsg),$("#indexDivSpan2").html(welcome)})}function showContentBolgList(a){$(".right").html("");var b,c=$(".blogList1");$.get(restUrl.获取博客列表,{pageNumber:a},function(a){if(200!=a.respCode)return void alert(a.message);for(b=a.data,i=0;7>=i&&i<=b.length-1;i++){var d=new Date(b[i].createTime).toLocaleString(),e=d.indexOf(" "),f=d.substring(0,e);f=d;var g="",h="",j="";if(0<b[i].isTop&&(g="\u7F6E\u9876"),""!=isLogin&&200==isLogin.respCode&&1==isLogin.data.userId)var h="\u66F4\u65B0\u6B64\u6587\u7AE0";0==b[i].isPublic&&(j="<span class=isTopSpan>\u79C1\u5BC6</span>"),c.children().html("<div class=\"contentsTheListContent\"><div class=\"headerNameDiv\"><span style=\"font-size: 25px;\">"+b[i].header+"</span><br /><span class=\"listDate\">posted: "+f+"</span> </div><div class = 'contentsTheListTime'>"+j+"<span class='isTopSpan'>"+g+"</span><a href=/upd-article?articleId="+b[i].id+">"+h+"</a></div><div class='AnHrLineInstance'></div> <div class='previewInstanceDiv'>  <span style='font-size: 18px;' class='previewSpanInstance'   >"+b[i].preview+"</span> </div>   </div>"),c.children().attr("id",b[i].id),c.children().addClass("innerContentListInstanceAndArticleId"),c=c.next()}if(8>b.length)for(i=0;i<8-b.length;i++)c.css("display","none"),c=c.next();else $(".contentList").css("display","block")}),$("#blogDetails").css("display","none"),$("#listBlog").css("display","block")}function showContentBolgDetails(a){showMarkdown(a),showComment(a),$("#listBlog").css("display","none"),$("#blogDetails").css("display","block"),$("body,html").animate({scrollTop:200},800)}function togglePage(a){if("next"==a){if(currentPage>=blogPageSum)return void alert("\u540E\u9762\u5DF2\u7ECF\u6CA1\u6709\u4E86");++currentPage}else{if(1==currentPage)return void alert("\u8FD9\u5DF2\u7ECF\u662F\u7B2C\u4E00\u9875\u4E86");--currentPage}location.hash="#list?pageNum="+currentPage,$("body,html").animate({scrollTop:200},700)}function init(){$(".index").addClass("hiddenIndex"),$(".content").addClass("contentLater"),setTimeout(function(){$(".index").remove()},2e3)}function hiddenBolgList(){$(".innerContentLeft").toggleClass("innerContentLeftFrames"),$(".innerContentRight").toggleClass("innerContentRightFrames"),isHidden?($("#gasga").html("\u5C55\u5F00\u535A\u5BA2\u5217\u8868"),isHidden=!1):($("#gasga").html("\u6536\u8D77\u535A\u5BA2\u5217\u8868"),isHidden=!0)}function addComment(){var a=$("#write").attr("replyFor"),b=$("#write").val(),c=$("#markDownArea").attr("name");alert("\u5C06\u8981\u56DE\u590Did\u4E3A\uFF1A"+a+"\u7684\u8BC4\u8BBA\uFF0C\u5F53\u524D\u8BC4\u8BBA\u5185\u5BB9\u4E3A"+b+"\u5F53\u524D\u535A\u5BA2id\u4E3A\uFF1A"+c);$.post(restUrl.添加评论,{blogId:c,replyFor:a,commentContent:b},function(a){200==a.respCode?alert("\u8BC4\u8BBA\u5DF2\u63D0\u4EA4\uFF0C\u5C06\u5728\u8FC7\u6EE4\u540E\u663E\u793A\uFF0C\u611F\u8C22\u60A8\u7684\u652F\u6301\uFF01"):alert(a.message)})}function commentChange(){var a=$("#write").val(),b=$(this).attr("id"),c=$(this).parent().parent().parent().parent().attr("userName"),d="\u767B\u9646\u4E4B\u540E\u53EF\u4EE5\u8FDB\u884C\u8BC4\u8BBA";$("#write").attr("replyFor",null),d="\u8D60\u4EBA\u73AB\u7470\uFF0C\u624B\u6709\u4F59\u9999",$("#write").attr("placeholder",d),$("#underCommentMsg").text("")}function cardHoverTranscation(){$(".contentList").addClass()}function toggleList(a){var b=a.children("#contentsTheArticleList");b.toggleClass("listCategoryInstance")}function categoryToggle(a,b){if(childrenHtml=b.children("#contentsTheArticleList"),null!=childrenHtml.html())return toggleList(b),0;$.post(restUrl.获取指定分类列表下的文章,{categoryId:a},function(a){if(200!=a.respCode||null==a.data||0==a.data.length)b.append("<div id = 'contentsTheArticleList' class = 'listCategoryInstancePre'>\u8FD8\u6CA1\u6709\u6587\u7AE0\u54E6</div>");else{a=a.data,html="";for(var c=a.length-1;0<=c;--c)html="<div id ="+a[c].articleId+" class = 'listCategory'>"+a[c].articleHeader+"</div>"+html;result="<div id = 'contentsTheArticleList' class = 'listCategoryInstancePre'>"+html+"</div>",b.append(result)}})}$(window).scroll(function(){var a=$(window).scrollTop();100<=a&&($(".test").addClass("low"),$("#innerTest").addClass("innerTestLower"),$("#text").addClass("textLower"),$("#HeaderText").addClass("HeaderTextLower"),$("#loginArea").addClass("loginAreaLower")),100>=a&&($(".test").removeClass("low"),$("#innerTest").removeClass("innerTestLower"),$("#text").removeClass("textLower"),$("#HeaderText").removeClass("HeaderTextLower"),$("#loginArea").removeClass("loginAreaLower"))}),$("#intoButtonIntence").click(function(){init()}),$("#gasga").click(function(){hiddenBolgList()}),$("#commentInstence").on("click",".theReplyButton",function(){var a=$(this).parent().parent().parent().parent(),b=a.attr("id"),c=a.attr("userName");$("#write").attr("replyFor",b),$("#write").attr("placeholder","\u56DE\u590D  --->"+c),$("#underCommentMsg").text("\u5F53\u524D\u6B63\u5728\u56DE\u590D:"+c+",\u70B9\u51FB\u6B64\u5904\u6587\u5B57\u53EF\u6E05\u9664\u56DE\u590D")}),$("#upcomment").click(function(){addComment()}),$("#commentInstence").on("mouseenter",".contentsTheHeaderArea",function(){$(this).children(".commentUserNameAndPostTime").children(".commentUserNameInstance").children(".theReplyButton").css("display","inline")}),$("#commentInstence").on("mouseleave",".contentsTheHeaderArea",function(){$(this).children(".commentUserNameAndPostTime").children(".commentUserNameInstance").children(".theReplyButton").css("display","none")}),$(".innerContentLeft").on("click",".listHeaderName",function(){category=$(this).parent();var a=$(this).parent().attr("id");categoryToggle(a,category)}),$(".innerContentLeft").on("click",".listCategory",function(){article=$(this).parent();var a=$(this).attr("id");null==a||0>=a||(location.hash="#details?articleId="+a)}),$(".contentList").click(function(){var a=$(this).children().attr("id");location.hash="#details?articleId="+a}),$(".blogNavigationBarLeft").click(function(){location.hash="#list?pageNum="+currentPage}),$(".pagebutton1").click(function(){togglePage("prefer")}),$(".pagebutton2").click(function(){togglePage("next")}),$("#write").focus(function(){$("#write").css("height","80px"),$("#contentsTheWrite").addClass("contentsTheWriteLater")}),$("#write").focusout(function(){$("#write").css("height","35px"),$("#contentsTheWrite").removeClass("contentsTheWriteLater")});function listFramesControl(){$("#indexDivSpan").addClass("indexDivSpanLater"),$("#indexDivSpan1").addClass("indexDivSpanLater1"),$("#indexDivSpan2").addClass("indexDivSpanLater2"),$("#intoButton").addClass("intoButtonLater")}$(document).ready(function(){if(addWelcomeMsgToDom(),addLoginMsgToDom(),listFramesControl(),""!=location.hash&&($(".content").addClass("contentLater"),$(".index").remove()),""==location.hash&&(location.hash="#list?pageNum=1"),""!=location.hash){var a=extractionLoc(location.hash);if("#list"!=a&&"#details"!=a&&(location.hash="#list?pageNum=1"),"#list"==a){var b=extractionArgm(location.hash);null!=b.pageNum&&0<b.pageNum&&(currentPage=b.pageNum)}}changePage(),setTimeout(function(){init()},18e4)});function extractionLoc(a){var b=a.indexOf("#"),c=a.indexOf("?");if(-1==c)return a;var d=a.substring(b,c);return d}function extractionArgm(a){var b=a.indexOf("?");if(-1==b)return null;var c=a.substring(b+1,a.length),d=c.indexOf("="),e=c.substr(0,d),f=c.substr(d+1,c.length);return{[e]:f}}function changePage(){var a=location.hash,b=extractionLoc(a),c=extractionArgm(a);"#list"==b&&null!=c.pageNum&&showContentBolgList(c.pageNum,!0),"#details"==b&&null!=c.articleId&&showContentBolgDetails(c.articleId)}$(window).bind("hashchange",function(){changePage()});